<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Repping It: Interactive Fitness Challenge | Gamified Workout Experience</title>

    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-QWTKZyjpPEjISv5WaRU9OFeRpok6YctnYmDr5pNlyT2bRjXh0JMhjY6hW+ALEwIH" crossorigin="anonymous">
    
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.min.js" integrity="sha384-0pUGZvbkm6XF6gxjEnlmuGrJXVbNuzT9qBBavbLwCsOGabYfZo0T0to5eqruptLy" crossorigin="anonymous"></script>
    <!-- Add GSAP CDN -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/gsap/3.12.5/gsap.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.min.js" integrity="sha384-0pUGZvbkm6XF6gxjEnlmuGrJXVbNuzT9qBBavbLwCsOGabYfZo0T0to5eqruptLy" crossorigin="anonymous"></script>
    <meta name="description" content="Repping It transforms everyday activities into exciting fitness challenges. Roll the dice to determine your workout reps based on common occurrences in your day-to-day life. Stay active and motivated while turning mundane moments into fun exercise opportunities. Unleash your inner beast and make fitness a part of your daily routine!.">

    <meta name="keywords" content="Repping It,Fitness game,Home workouts,Active lifestyle,Exercise challenges,Fun fitness activities,Dice workout,Motivational fitness,Healthy living,Interactive exercise,Unique workout routines,Fitness tracker,Outdoor workouts,Home fitness challenges">

    <meta property="og:title" content="Repping It: Interactive Fitness Challenge | Gamified Workout Experience">
    <meta property="og:description" content="Repping It transforms everyday activities into exciting fitness challenges. Roll the dice to determine your workout reps based on common occurrences in your day-to-day life. Stay active and motivated while turning mundane moments into fun exercise opportunities. Unleash your inner beast and make fitness a part of your daily routine!.">
    <meta property="og:url" content="https://dean1234533.github.io/Repping-It">
    <meta property="og:type" content="website">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <link rel="canonical" href="https://dean1234533.github.io/Repping-It"/>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css">
    
   <style>
   * {
            box-sizing: border-box;
            margin: 0;
            padding: 0;
            font-family: Arial, sans-serif;
        }

        body {
            background: linear-gradient(135deg, #1a1a1a, #2c3e50);
            color: #fff;
            min-height: 100vh;
            display: flex;
            flex-direction: column;
            justify-content: space-between;
            align-items: center;
            position: relative;
            overflow-x: hidden;
        }

        .footer {
    display: flex;
    flex-wrap: wrap;
    justify-content: space-between;
    align-items: center;
    padding: 20px;
    
    color: white;
    font-size: small;
    width: 100%;
}


    /* Add hover effect glow */
    .card:hover .card-inner {
        box-shadow: 0 0 25px rgba(179, 59, 46, 0.6);
    }
    
    /* Add this for shine effect */
    .card-shine {
        position: absolute;
        top: 0;
        left: 0;
        right: 0;
        bottom: 0;
        border-radius: 8px;
        background: linear-gradient(135deg, rgba(255,255,255,0) 0%, rgba(255,255,255,0.3) 50%, rgba(255,255,255,0) 100%);
        opacity: 0;
        pointer-events: none;
        z-index: 10;
    }

.footer-links {
    display: flex;
    flex-wrap: wrap;
    gap: clamp(10px, 2vw, 20px);
    color: #e3dede;
}

.footer-links a {
    color: rgb(234, 239, 231);
    text-decoration: none;
    font-weight: bold;
}



        .container {
            max-width: 1200px;
            width: 100%;
            text-align: center;
            position: relative;
            z-index: 1;
            background: rgba(0, 0, 0, 0.5);
            border-radius: 20px;
            backdrop-filter: blur(10px);
            box-shadow: 0 10px 30px rgba(0, 0, 0, 0.5);
            padding: 20px;
            margin: 20px auto;
        }

        h1 {
            font-size: clamp(1.5rem, 5vw, 3rem);
            margin-bottom: 10px;
            text-shadow: 0 4px 8px rgba(0, 0, 0, 0.5);
            background: linear-gradient(to right, #fff, #ccc);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
        }

        .controls {
            margin-top: 30px;
            display: flex;
            justify-content: center;
            align-items: center;
            flex-wrap: wrap;
            gap: 20px;
        }

        select, button {
            background: rgba(255, 255, 255, 0.15);
            color: white;
            border: none;
            padding: 12px 25px;
            border-radius: 25px;
            cursor: pointer;
            font-size: 16px;
            transition: all 0.3s ease;
        }

        button {
            background-color: #b33b2e;
        }

        button:hover {
            background: rgba(141, 42, 42, 0.25);
            transform: translateY(-3px);
        }

        button:active {
            transform: translateY(1px);
        }

        select:hover {
            background: rgba(255, 255, 255, 0.25);
        }

        .card-container {
            width: 100%;
            display: flex;
            justify-content: center;
            align-items: center;
            position: relative;
            height: 350px;
            margin: 30px 0;
            
        }

        .card-stack {
            display: none;
            position: absolute;
            width: 100%;
            height: 100%;
            justify-content: center;
            align-items: center;
           
        }

        .card {
            display: none;
            perspective: 1000px;
            width: 224px;
            height: 336px;
            margin: 0 auto;
            position: relative; /* Added for gloss effect */
            overflow: hidden; /* Added for gloss effect */
        
        }

        .card-inner {
            position: relative;
            width: 100%;
            height: 100%;
            text-align: center;
            transition: transform 0.6s;
            transform-style: preserve-3d;
            box-shadow: 0 4px 8px rgba(0, 0, 0, 0.2);
            border-radius: 8px;
            cursor: pointer;
            
         
        }

        .card-inner.flipped {
            transform: rotateY(180deg);
            
           
        }
        h1 {
    font-size: clamp(24px, 5vw, 48px);
}

h2 {
    font-size: clamp(20px, 4vw, 36px);
}

h3 {
    font-size: clamp(18px, 3.5vw, 30px);
}

p, ol, ul {
    font-size: clamp(14px, 2.5vw, 20px);
    line-height: 1.6;
    
}

        .card-front, .card-back {
            position: absolute;
            width: 100%;
            height: 100%;
            -webkit-backface-visibility: hidden;
            backface-visibility: hidden;
            align-items: center;
            justify-content: center;
            border-radius: 8px;
            padding: 15px;
        }
    .card-front {
    background-image: url('IMG_4715.JPG'); /* Add background image */
    background-size: cover; /* Cover the entire card */
    background-position: center; /* Center the image */;
    justify-content: center;
    align-items: center;
    color: rgb(230, 224, 224);
    
}
        .card-front {
           
        display: flex;
        text-align: center;
        justify-content: center;
            background-color: #3498db;
            color: white;
            font-size: 14px;
            text-align: center;
            
        }

        .card-back {
            background-image: url('annie-spratt-6a3nqQ1YwBw-unsplash.jpg'); /* Add background image */
            background-size: cover; /* Cover the entire card */
    background-position: center; /* Center the image */
            display: grid;
            color: #f6eded;
justify-content: center;
text-align: center;
line-height: 2px;
            transform: rotateY(180deg);
            font-size: 25px;
            padding-top: 2px;
            text-align: center;
        }

        /* Gloss Effect */
        .card:before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(255, 255, 255, 0.1);
            background: linear-gradient(180deg, rgba(255, 255, 255, 0.1) 50%, rgba(255, 255, 255, 0) 100%);
            border-radius: 8px;
            opacity: 0.5; /* Adjust opacity for gloss */
            pointer-events: none; /* Prevents interfering with clicks */
        }

        .navigation {
            width: 100%;
            display: flex;
            justify-content: center;
            gap: 20px;
            margin-top: 20px;
            margin-bottom: 30px;  
        }

        .dice-container {
            
            margin-top: 30px;
            display: flex;
            flex-direction: column;
            align-items: center;
            gap: 15px;
        }

        .dice {
            width: 80px;
            height: 80px;
            display: flex;
            justify-content: center;
            align-items: center;
        }

        #diceImage {
            
            width: 200px;
            height: 200px;
            transition: transform 0.5s ease;
        }

        .rolling {
            
            animation: rollDice 0.5s ease-out 3;
        }

        @keyframes rollDice {
            0% { transform: rotate(0deg) scale(1); }
            50% { transform: rotate(180deg) scale(1.2); }
            100% { transform: rotate(360deg) scale(1); }
        }

        .dice-controls, .tally-controls {
            display: flex;
            justify-content: center;  
            gap: 15px;            
            margin: 20px 0;          
        }

        .stats {
            margin-top: 30px;       
            margin-bottom: 20px;    
            display: flex;
            justify-content: center;
            gap: 30px;
            font-size: 18px;
        }

        /* Difficulty buttons container */
        .difficulty-container {
            display: flex;
            flex-direction: column;
            align-items: center;
            gap: 20px;
            margin: 30px 0;          
        }

        .difficulty-title {
            font-size: 20px;
            margin-bottom: 10px;    
        }

        .difficulty-buttons {
            display: flex;
            justify-content: center;
            gap: 15px;              
            flex-wrap: wrap;
        }

        /* Style difficulty buttons differently */
        .difficulty-btn {
            padding: 12px 25px;
            border-radius: 25px;
            min-width: 120px;
            font-weight: bold;
            transition: all 0.3s ease;
        }

        .difficulty-btn.active {
            box-shadow: 0 0 15px rgba(255, 255, 255, 0.5);
            transform: scale(1.05);
        }

        .low-btn {
            background-color: #27ae60;  
        }

        .medium-btn {
            background-color: #f39c12;  
        }

        .high-btn {
            background-color: #e74c3c;  
        }

        /* Section dividers */
        .section-divider {
            width: 80%;
            height: 1px;
            background: linear-gradient(to right, transparent, rgba(255, 255, 255, 0.5), transparent);
            margin: 30px auto;
        }

        /* Modal Styles */
        .modal-header {
            background-color: #b33b2e; /* Same color as buttons */
            color: white;
        }

        @media (max-width: 768px) {
            .controls, .difficulty-buttons {
                flex-direction: column;
                align-items: center;
            }
            
            .card {
                width: 160px;
                height: 240px;
                ;
            }
            .card-back-list{margin-top: -25px;}
            .dice {
                width: 60px;
                height: 60px;
            }
            p{margin-top: -10px;}
            #diceImage {
                width: 150px;
                height: 150px;
            }
            
            .stats {
                flex-direction: column;
                gap: 10px;
                align-items: center;
            }

            a{padding: 10px;}
        }
    /* Additional small device optimizations */
    @media (max-width: 480px) {
        .card {
            width: clamp(100px, 40vw, 140px);
            height: clamp(150px, 60vw, 210px);
        }
        
        .card-back {
            font-size: clamp(16px, 5vw, 25px);
        }
        
        .container {
            width: 98%;
            padding: 10px 5px;
        }
        
        button, select {
            padding: 8px 15px;
            font-size: clamp(12px, 3vw, 14px);
        }
        
        .difficulty-btn {
            min-width: 100px;
            padding: 8px 15px;
        }
        
        input {
            width: 60px;
            padding: 8px;
        }
    }
    
    /* Landscape mode optimizations */
    @media (max-height: 600px) and (orientation: landscape) {
        .card-container {
            height: 70vh;
        }
        
        .card {
            width: clamp(100px, 25vw, 170px);
            height: clamp(150px, 37.5vw, 255px);
        }
        
        .container {
            margin: 10px auto;
        }
        
        .dice-container {
            margin-top: 15px;
        }
        
        .section-divider {
            margin: 15px auto;
        }
        
        .difficulty-container {
            margin: 15px 0;
        }
        
        h1 {
            margin-bottom: 5px;
        }
    }
</style>
</head>
<body>
    <div class="container">
        <h1>Repping It: Fitness Card Game</h1>
        
        <div class="controls">
            <select id="stack-select">
                <option value="1">Home Work</option>
                <option value="3">Office Rep</option>
                <option value="4">Remote Flex</option>
                <option value="5">OutFit</option>
                <option value="6">Pyramid Hustle</option>
                <option value="2">Family Fun</option>
                <option value="7">Party Clash</option>
                <option value="8">Fit Parents</option>
                <option value="9">Time Crusher</option>
            </select>
            <button id="shuffle-btn">Shuffle Cards</button>
            <button id="game-rules-btn" data-bs-toggle="modal" data-bs-target="#rulesModal">Game Rules</button>
        </div>
    
        <div class="card-container">
            <!-- Home Workout -->
            <div id="stack1" class="card-stack">
                <div class="card">
                    <div class="card-inner">
                        <div class="card-front">Tap To Flip</div>
                        <div class="card-back">
                            <h3>Laugh Out Loud</h3>
                            <p>Every time you hear a laugh</p><br><br>
                            <p>Do:<br> <a href="https://youtube.com/shorts/S0oc8-a1eoo" style="color: #b33b2e; text-decoration: underline;">Straight Leg Toe Touch</a></p>
                        </div>
                    </div>
                </div>
                <div class="card">
                    <div class="card-inner">
                        <div class="card-front">Tap To Flip</div>
                        <div class="card-back">
                            <h3>Call to Action</h3>
                            <p>Every time the phone rings</p><br><br>
                            <p>Do:<br> <a href="https://youtube.com/shorts/wKvR_B0Gbus" style="color: #b33b2e; text-decoration: underline;">Cross Jacks</a></p>
                        </div>
                    </div>
                </div>
                <div class="card">
                    <div class="card-inner">
                        <div class="card-front">Tap To Flip</div>
                        <div class="card-back">
                            <h3>YouTube Ad App</h3>
                            <p>Every time YouTube ad appears</p><br><br>
                            <p>Do:<br> <a href="https://youtube.com/shorts/mI-4ppo3nD4" style="color: #b33b2e; text-decoration: underline;">Diamond Push Ups</a></p>
                        </div>
                    </div>
                </div>
                <div class="card">
                    <div class="card-inner">
                        <div class="card-front">Tap To Flip</div>
                        <div class="card-back">
                            <h3>Tweet and Tone</h3>
                            <p>Every time you see a bird</p><br><br>
                            <p>Do:<br> <a href="https://youtube.com/shorts/8r0k1cWA068" style="color: #b33b2e; text-decoration: underline;">Standing Side Crunch</a></p>
                        </div>
                    </div>
                </div>
            </div>
            
            <!-- Family Fun -->
            <div id="stack2" class="card-stack">
                <div class="card">
                    <div class="card-inner">
                        <div class="card-front">Tap To Flip</div>
                        <div class="card-back">
                            <h3>30 Day Fitness</h3><br>
                            <p>Do a short workout together (10-15 mins)<br> </p><br><br>
                            <div class="card-back-list"> 
                                <p><a href="https://youtube.com/shorts/uTbfBwpUftw" style="color: #b33b2e; text-decoration: underline;">Lightning Legs</a></p>
                                <p><a href="https://youtube.com/shorts/j588IjqLyok" style="color: #b33b2e; text-decoration: underline;">Captain Flutter</a></p>
                                <p><a href="https://youtube.com/shorts/vppEPyQpF-Q" style="color: #b33b2e; text-decoration: underline;">Jet Plank</a></p>
                            </div>
                        </div>
                    </div>
                </div>
                <div class="card">
                    <div class="card-inner">
                        <div class="card-front">Tap To Flip</div>
                        <div class="card-back">
                            <h3>Freeze Tag Fitness</h3>
                            <p>Freeze tag, but to unfreeze</p><br><br>
                            <p>Do: <br><a href="https://youtube.com/shorts/zbAcjZkZzHA" style="color: #b33b2e; text-decoration: underline;">Hand Walkout</a><br>& <br>Silly dance</p>
                        </div>
                    </div>
                </div>
                <div class="card">
                    <div class="card-inner">
                        <div class="card-front">Tap To Flip</div>
                        <div class="card-back">
                            <h3>The Floor is Lava </h3>
                            <p>Everyone has 5 seconds to get off the floor</p><br><br>
                            <p>Last one off the floor does:<br> <a href="https://youtube.com/shorts/CrroLZeeLlU" style="color: #b33b2e; text-decoration: underline;">Plank Punches</a></p>
                        </div>
                    </div>
                </div>
                <div class="card">
                    <div class="card-inner">
                        <div class="card-front">Tap To Flip</div>
                        <div class="card-back">
                            <h3>Mirror Me</h3>
                            <p>The leader moves however they want, while the other mirrors them.(Dice number = number of moves)</p><br><br>
                            <p>Loser does: Silly Dance</p>
                        </div>
                    </div>
                </div>
            </div>
            
            <!-- Office Workout -->
            <div id="stack3" class="card-stack">
                <div class="card">
                    <div class="card-inner">
                        <div class="card-front">Tap To Flip</div>
                        <div class="card-back">
                            <h3>Inbox Intervals</h3>
                            <p>Every email notification</p><br><br>
                            <p>Do:<br> <a href="https://youtube.com/shorts/LxEvqzhY7Cw" style="color: #b33b2e; text-decoration: underline;">Chair Dips</a></p>
                        </div>
                    </div>
                </div>
                <div class="card">
                    <div class="card-inner">
                        <div class="card-front">Tap To Flip</div>
                        <div class="card-back">
                            <h3>Every Check In</h3>
                            <p>Every time you check your phone</p><br><br>
                            <p>Do:<br> <a href="https://youtube.com/shorts/OW3E2FhSjPg" style="color: #b33b2e; text-decoration: underline;">Calf Raises</a></p>
                        </div>
                    </div>
                </div>
                <div class="card">
                    <div class="card-inner">
                        <div class="card-front">Tap To Flip</div>
                        <div class="card-back">
                            <h3>Sip & Sweat</h3>
                            <p>Every coffee break</p><br><br>
                            <p>Do:<br> <a href="https://youtube.com/shorts/V47pG-zWjwA" style="color: #b33b2e; text-decoration: underline;">Wall Push Ups</a></p>
                        </div>
                    </div>
                </div>
                <div class="card">
                    <div class="card-inner">
                        <div class="card-front">Tap To Flip</div>
                        <div class="card-back">
                            <h3>Rise and Shine</h3>
                            <p>Every time you stand up</p><br><br>
                            <p>Do:<br> <a href="https://youtube.com/shorts/3bHwrNcx8ww" style="color: #b33b2e; text-decoration: underline;">Chair Squats</a></p>
                        </div>
                    </div>
                </div>
            </div>
            
            <!-- TV Workout -->
            <div id="stack4" class="card-stack">
                <div class="card">
                    <div class="card-inner">
                        <div class="card-front">Tap To Flip</div>
                        <div class="card-back">
                            <h3>Snack Attack Set</h3>
                            <p>For every snack you grab</p><br><br>
                            <p>Do:<br> <a href="https://youtube.com/shorts/Y-cvP_XZcQQ" style="color: #b33b2e; text-decoration: underline;">Ski Jumps</a></p>
                        </div>
                    </div>
                </div>
                <div class="card">
                    <div class="card-inner">
                        <div class="card-front">Tap To Flip</div>
                        <div class="card-back">
                            <h3>Closet Call</h3>
                            <p>Every time a character changes outfits</p><br><br>
                            <p>Do:<br> <a href="https://youtube.com/shorts/mI-4ppo3nD4" style="color: #b33b2e; text-decoration: underline;">Diamond Push Ups</a></p>
                        </div>
                    </div>
                </div>
                <div class="card">
                    <div class="card-inner">
                        <div class="card-front">Tap To Flip</div>
                        <div class="card-back">
                            <h3>Scroll & Sweat</h3>
                            <p>Every time you check social media</p><br><br>
                            <p>Do:<br> <a href="https://youtube.com/shorts/NSo7v8taJKw" style="color: #b33b2e; text-decoration: underline;">Crunches</a></p>
                        </div>
                    </div>
                </div>
                <div class="card">
                    <div class="card-inner">
                        <div class="card-front">Tap To Flip</div>
                        <div class="card-back">
                            <h3>Showtime Sweat</h3>
                            <p>For every new show that comes to netflix</p><br><br>
                            <p>Do:<br> <a href="https://youtube.com/shorts/56yOUm3WOZM" style="color: #b33b2e; text-decoration: underline;">Push Ups</a></p>
                        </div>
                    </div>
                </div>
            </div>
    
            <!-- Outdoor Workout -->
            <div id="stack5" class="card-stack">
                <div class="card">
                    <div class="card-inner">
                        <div class="card-front">Tap To Flip</div>
                        <div class="card-back">
                            <h3>Delivery Driver Drop Set</h3>
                            <p>Every time you see a food delivery rider</p><br><br>
                            <p>Do:<br> <a href="https://youtube.com/shorts/vaQ8TuLpjdo" style="color: #b33b2e; text-decoration: underline;">Mountain Climbers</a></p>
                        </div>
                    </div>
                </div>
                <div class="card">
                    <div class="card-inner">
                        <div class="card-front">Tap To Flip</div>
                        <div class="card-back">
                            <h3>Pothole Pounder</h3>
                            <p>Each pothole you see</p><br><br>
                            <p>Do:<br> <a href="https://youtube.com/shorts/sghzl-NslKE" style="color: #b33b2e; text-decoration: underline;">Jump Squats</a></p>
                        </div>
                    </div>
                </div>
                <div class="card">
                    <div class="card-inner">
                        <div class="card-front">Tap To Flip</div>
                        <div class="card-back">
                            <h3>L Plate Lifter</h3>
                            <p>Every car/bike with a L plate</p><br><br>
                            <p>Do:<br> <a href="https://youtube.com/shorts/QC1RKGE9wjc" style="color: #b33b2e; text-decoration: underline;">Lunges</a></p>
                        </div>
                    </div>
                </div>
                <div class="card">
                    <div class="card-inner">
                        <div class="card-front">Tap To Flip</div>
                        <div class="card-back">
                            <h3>Construction Crusher</h3>
                            <p>Each time you see roadworks</p><br><br>
                            <p>Do:<br> <a href="https://youtube.com/shorts/zzNwlVK_XPg" style="color: #b33b2e; text-decoration: underline;">Tuck Jumps</a></p>
                        </div>
                    </div>
                </div>
            </div>
            
            <!-- Pyramid Workout -->
            <div id="stack6" class="card-stack">
                <div class="card">
                    <div class="card-inner">
                        <div class="card-front">Tap To Flip</div>
                        <div class="card-back">
                            <h3>Pyramid Sweat</h3><br>
                            <p>You start with 1 rep, go up to a peak (say 10), then back down to 1.</p><br><br>
                            <p>Reps based off dice roll, do:<br><br> <a href="https://youtube.com/shorts/AhunaH0K2VM" style="color: #b33b2e; text-decoration: underline;">Squats</a></p>
                        </div>
                    </div>
                </div>
                <div class="card">
                    <div class="card-inner">
                        <div class="card-front">Tap To Flip</div>
                        <div class="card-back">
                            <h3>Pyramid Sweat</h3><br>
                            <p>You start with 1 rep, go up to a peak (say 10), then back down to 1.</p><br><br>
                            <p>Reps based off dice roll, do:<br><br> <a href="https://youtube.com/shorts/56yOUm3WOZM" style="color: #b33b2e; text-decoration: underline;">Press Ups</a></p>
                        </div>
                    </div>
                </div>
                <div class="card">
                    <div class="card-inner">
                        <div class="card-front">Tap To Flip</div>
                        <div class="card-back">
                            <h3>Pyramid Sweat</h3><br>
                            <p>You start with 1 rep, go up to a peak (say 10), then back down to 1.</p><br><br>
                            <p>Reps based off dice roll, do:<br><br> <a href="https://youtube.com/shorts/-r0tnaEJsGw" style="color: #b33b2e; text-decoration: underline;">Burpees</a></p>
                        </div>
                    </div>
                </div>
                <div class="card">
                    <div class="card-inner">
                        <div class="card-front">Tap To Flip</div>
                        <div class="card-back">
                            <h3>Pyramid Sweat</h3><br>
                            <p>You start with 1 rep, go up to a peak (say 10), then back down to 1.</p><br><br>
                            <p>Reps based off dice roll, do:<br><br> <a href="https://youtube.com/shorts/YyO7WrwFo6M" style="color: #b33b2e; text-decoration: underline;">Sit Up</a></p>
                        </div>
                    </div>
                </div>
            </div>
            
            <!-- Party Power Challenges -->
            <div id="stack7" class="card-stack">
                <div class="card">
                    <div class="card-inner">
                        <div class="card-front">Tap To Flip</div>
                        <div class="card-back">
                            <h3>Reverse Fitness</h3>
                            <p>
                                Move backwards! Lunges, crawls, burpees — but every move must be done in reverse. 
                                Roll the dice to see how many reverse moves you must complete. Mess up? Add 5 penalty situps!
                            </p>
                        </div>
                    </div>
                </div>
                <div class="card">
                    <div class="card-inner">
                        <div class="card-front">Tap To Flip</div>
                        <div class="card-back">
                            <h3>Dodge Drop</h3>
                            <p>
                                Keep moving until you hear "DROP!" — then hit the floor fast with a burpee or pushup.
                                Roll the dice to find out how many drops you must survive. Last to drop? Do 20 mountain climbers!
                            </p>
                        </div>
                    </div>
                </div>
                <div class="card">
                    <div class="card-inner">
                        <div class="card-front">Tap To Flip</div>
                        <div class="card-back">
                            <h3>Balance Battle</h3>
                            <p>
                                Stand on one leg! Roll the dice to set your balance time (seconds). Follow quick commands (clap, squat, touch ground) without falling. 
                                Last one balancing wins!
                            </p>
                        </div>
                    </div>
                </div>
                <div class="card">
                    <div class="card-inner">
                        <div class="card-front">Tap To Flip</div>
                        <div class="card-back">
                            <h3>Pulse Party</h3>
                            <p>
                                Pick a pulse move (bounce squats, jogging). Roll the dice to set your pulse reps. 
                                When the music drops — hit the floor in plank and pop back up fast!
                            </p>
                        </div>
                    </div>
                </div>
            </div>
            
            <!-- Parent Power Challenges -->
            <div id="stack8" class="card-stack">
                <div class="card">
                    <div class="card-inner">
                        <div class="card-front">Tap To Flip</div>
                        <div class="card-back">
                            <h3>Nappy Ninja</h3>
                            <p> 
                                Every time you do a nappy change, drop and do 10 fast squats — ninja style! Bonus: Add a high jump if it's a messy one!
                            </p>
                        </div>
                    </div>
                </div>
                <div class="card">
                    <div class="card-inner">
                        <div class="card-front">Tap To Flip</div>
                        <div class="card-back">
                            <h3>Toy Tidy Toss</h3>
                            <p>
                                Every time you pick up toys off the floor, throw in 5 lunges for every toy! Power-up: Add a jump lunge every 5th toy.
                            </p>
                        </div>
                    </div>
                </div>
                <div class="card">
                    <div class="card-inner">
                        <div class="card-front">Tap To Flip</div>
                        <div class="card-back">
                            <h3>Snack Time Sizzler</h3>
                            <p>
                                Every time you prep a snack or feed the little one, hold a wall-sit for 30 seconds. Add 5 calf raises at the end to spice it up!
                            </p>
                        </div>
                    </div>
                </div>
                <div class="card">
                    <div class="card-inner">
                        <div class="card-front">Tap To Flip</div>
                        <div class="card-back">
                            <h3>Storybook Squats</h3>
                            <p>
                                During story time, do 1 squat for every page you read out loud! Bonus: Add a jump every time there's a funny sound or animal noise!
                            </p>
                        </div>
                    </div>
                </div>
            </div>
            <div id="stack9" class="card-stack">
                <div class="card">
                    <div class="card-inner">
                        <div class="card-front">Tap To Flip</div>
                        <div class="card-back">
                            <h3>Stair Climb Challenge</h3><br>
                            <p>Set a timer for 10 minutes and climb stairs continuously. Aim for maximum repetitions!</p><br><br>
                            <p>For added intensity, do:<br><br> Step Ups</p>
                        </div>
                    </div>
                </div>
                <div class="card">
                    <div class="card-inner">
                        <div class="card-front">Tap To Flip</div>
                        <div class="card-back">
                            <h3>Nature Walk Fitness Challenge</h3><br>
                            <p>Set a timer for 30 minutes and explore a natural area. Stop every 5 minutes to do 10 push-ups!</p><br><br>
                            <p>Mix it up with: <a href="https://youtube.com/shorts/QC1RKGE9wjc" style="color: #b33b2e; text-decoration: underline;">Alternating Lunges</a></p>
                        </div>
                    </div>
                </div>
                <div class="card">
                    <div class="card-inner">
                        <div class="card-front">Tap To Flip</div>
                        <div class="card-back">
                            <h3>Fitness Alphabet Challenge</h3><br>
                            <p>Set a timer for 20 minutes. Spell out a word using exercises (A=Arm Circles, B=Burpees). Complete the reps as you go!</p><br><br>
                            <p>For each letter do:<br><a href="https://youtube.com/shorts/wKvR_B0Gbus" style="color: #b33b2e; text-decoration: underline;">Cross Jacks</a></p>
                        </div>
                    </div>
                </div>
                <div class="card">
                    <div class="card-inner">
                        <div class="card-front">Tap To Flip</div>
                        <div class="card-back">
                            <h3>5-Minute Freestyle Challenge</h3><br>
                            <p>Set a timer for 5 minutes and perform any exercise you want. Switch it up every minute!</p><br><br>
                            <p>Try combining with:<br> <a href="https://youtube.com/shorts/F1nZSWab1aA" style="color: #b33b2e; text-decoration: underline;">High Knees</a></p>
                        </div>
                    </div>
                </div>
           
           
                <div class="card">
                    <div class="card-inner">
                        <div class="card-front">Tap To Flip</div>
                        <div class="card-back">
                            <h3>Split Time Challenge</h3><br>
                            <p>Set a timer for 20 minutes. Alternate between 2 minutes of high-intensity exercise and 2 minutes of low-intensity recovery.</p><br><br>
                            <p>For high intensity, do: <a href="https://youtube.com/shorts/-r0tnaEJsGw" style="color: #b33b2e; text-decoration: underline;">Burpees</a></p>
                        </div>
                    </div>
                </div>
                
                <div class="card">
                    <div class="card-inner">
                        <div class="card-front">Tap To Flip</div>
                        <div class="card-back">
                            <h3>15-Minute Circuit Countdown</h3><br>
                            <p>Set a timer for 15 minutes. Complete a circuit of exercises for 1 minute each, resting for 15 seconds between.</p><br><br>
                            <p>Include exercises like:<br><br> <a href="https://youtube.com/shorts/AhunaH0K2VM" style="color: #b33b2e; text-decoration: underline;">Squats</a></p>
                        </div>
                    </div>
                </div>
            </div>
         </div>
      

        
        


       
        
        <div class="navigation">
            <button id="prev-card-btn">Previous Card</button>
            <button id="next-card-btn">Next Card</button>
        </div>

        <div class="section-divider"></div>
        

        
        
        <!-- New Difficulty Selector -->
        <div class="difficulty-container">
            <div class="difficulty-title">Select Difficulty Level</div>
            <div class="difficulty-buttons">
                <button id="low-btn" class="difficulty-btn low-btn">Low</button>
                <button id="medium-btn" class="difficulty-btn medium-btn">Medium</button>
                <button id="high-btn" class="difficulty-btn high-btn">High</button>
            </div>
            <div id="difficulty-info">
                Current Level: Low (2, 4, 6, 8, 10 reps)
            </div>
        </div>
        
        <div class="section-divider"></div>
       
        <div class="dice-container">
            <div class="dice">
                <img id="diceImage" src="IMG_4702.PNG" alt="Dice" />
            </div>
            <div class="dice-controls">
                <button id="roll-dice-btn">Roll Dice</button>
                <button id="reset-dice-btn">Reset Dice</button>
            </div>
        </div>
        
        <div class="section-divider"></div>
        
        <div class="tally-controls">
            <button id="tally-btn">Add Tally</button>
            <button id="reset-tally-btn">Reset Tally</button>
        </div>
        
        <div class="stats">
            <div id="totalReps">Total Reps: 0</div>
            <div id="tallyCountDisplay">Tally Count: 0</div>
        </div>

        <div class="section-divider"></div>

        <div>
            <input type="number" id="minutes" placeholder="Min" min="0">
            <input type="number" id="seconds" placeholder="Sec" min="0" max="59">
        </div>
        <audio id="buzzer" src="digital-timer-beeping-epic-stock-media-1-00-08.mp3"></audio>
        <div id="timer">00:00</div>
        
        <div>
            <button onclick="startTimer()">Start</button>
            <button onclick="resetTimer()">Reset</button>
        </div>
        
        <!-- Buzzer sound -->
       
        
        
        
    
        <footer class="footer">
            <div class="footer-links">
        
             
        
        
                <a href="https://dbworkouts.co.uk/index.html" target="_blank">Website
                <img src="photo-output 7.PNG" style="color: white"alt="business logo" width="30">
              
    
              
        
           
            
               
            </div>
        </footer>
    </div>

   
    
    <!-- Modal for Game Rules -->
    <div class="modal fade" id="rulesModal" tabindex="-1" aria-labelledby="rulesModalLabel" aria-hidden="true">
        <div class="modal-dialog modal-lg">
            <div class="modal-content">
                <div class="modal-header">
                    <h5 class="modal-title" id="rulesModalLabel">Game Rules</h5>
                    <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
                </div>
                <div class="modal-body"style="color:black">
                    <h6>Game Setup</h6>
                    <ol>
                        <li>Pick Your Daily Scenario (or let fate decide):
                            <p>Use the cards to randomly pick one or more of the following challenges each day. Then roll the dice to get your reps.</p>
                        </li>
                        <li>Track Your Reps: Use the in-game tally counter. At the end of the day, add up the total reps.</li>
                        <li>Finish Strong: Complete your reps at once or spread them throughout the day. The only rule is - get it done.</li>
                    </ol>
                    <h6>Warm-Up: "Ignite the Engine"</h6>
                    <p>Always warm up first to avoid injuries and get in the zone.</p>
                    <h6>Stretch it Out: "Cooldown Flow"</h6>
                    <p>After completing your reps, cool down and stretch to reduce soreness.</p>
                    <h6>Final Word</h6>
                    <p>Repping It isn't just a workout - it's a lifestyle challenge. You'll never watch TV, walk to the shop, or scroll through YouTube the same way again.</p>
                </div>
            </div>
        </div>
    </div>

   <script>
        let audioContext;

// Improved audio context initialization with better mobile support
function initAudioContext() {
    try {
        if (!audioContext) {
            // Use AudioContext with fallbacks for older browsers
            audioContext = new (window.AudioContext || window.webkitAudioContext)();
        }

        // Resume audio context if it's suspended (browser policy requirement)
        if (audioContext && audioContext.state === 'suspended') {
            audioContext.resume();
        }
        return true;
    } catch (error) {
        console.error("Audio Context initialization failed:", error);
        return false;
    }
}

// Initialize on user interaction to handle autoplay restrictions
// Using { once: true } as initializing on first interaction is usually sufficient
document.addEventListener('click', initAudioContext, { once: true });
document.addEventListener('touchstart', initAudioContext, { once: true });

// Function to show custom message box (replacing alert)
function showMessageBox(message) {
    const messageBox = document.getElementById('messageBox');
    const messageBoxText = document.getElementById('messageBoxText');
    if (messageBox && messageBoxText) {
        messageBoxText.textContent = message;
        messageBox.classList.remove('hidden');
    }
}

// Function to hide custom message box
function hideMessageBox() {
    const messageBox = document.getElementById('messageBox');
    if (messageBox) {
        messageBox.classList.add('hidden');
    }
}

// Enhanced fallback beep using Web Audio API with better mobile support
function createBeep() {
    if (!initAudioContext()) return;

    try {
        const oscillator = audioContext.createOscillator();
        const gainNode = audioContext.createGain();

        oscillator.connect(gainNode);
        gainNode.connect(audioContext.destination);

        oscillator.type = 'square';
        oscillator.frequency.value = 800;
        gainNode.gain.value = 0.3; // Lower volume for mobile

        oscillator.start();

        // Beep for 0.3 seconds
        setTimeout(() => {
            oscillator.stop();
        }, 300);
    } catch (error) {
        console.error("Beep creation failed:", error);
    }
}

// Improved sound player with multiple fallbacks for mobile
function playSound() {
    // First try: HTML5 Audio
    try {
        // Create new audio element each time instead of reusing
        // Note: Make sure 'digital-timer-beeping-epic-stock-media-1-00-08.mp3' is accessible
        const buzzer = new Audio('digital-timer-beeping-epic-stock-media-1-00-08.mp3');
        buzzer.volume = 0.5; // Lower volume for mobile

        // Try to play the audio
        const playPromise = buzzer.play();

        if (playPromise !== undefined) {
            playPromise
                .then(() => {
                    console.log("Buzzer sound played successfully");
                })
                .catch(error => {
                    console.log("Error playing buzzer sound:", error);
                    // Second try: Use existing audio element (less reliable on mobile autoplay)
                    const originalBuzzer = document.getElementById('buzzer');
                    if (originalBuzzer) {
                        originalBuzzer.currentTime = 0;
                        originalBuzzer.play().catch(() => {
                            // Third try: Web Audio API as final fallback
                            createBeep();
                        });
                    } else {
                        // Direct to third try if no audio element exists
                        createBeep();
                    }
                });
        }
    } catch (error) {
        console.error("Sound playback failed:", error);
        createBeep(); // Final fallback
    }
}

// Improved touch handling for mobile devices
function enableTouchSupport() {
    // Map touch events to mouse events for card interactions
    document.addEventListener('touchstart', function(e) {
        // Don't prevent default for elements that need native touch behavior
        const target = e.target;
        const targetTagName = target.tagName.toLowerCase();
        const isInteractive = targetTagName === 'button' ||
                             targetTagName === 'input' ||
                             targetTagName === 'select' ||
                             target.closest('.card-inner'); // Include card-inner for flip

        if (isInteractive) {
            // Prevent default only if we are handling the interaction
            e.preventDefault();

            // Map the first touch point to mousedown for interactive elements
            if (e.touches.length > 0) {
                const touch = e.touches[0];
                const mouseEvent = new MouseEvent('mousedown', {
                    clientX: touch.clientX,
                    clientY: touch.clientY,
                    bubbles: true,
                    cancelable: true // Make event cancelable
                });
                // Dispatch on the actual element that was touched
                touch.target.dispatchEvent(mouseEvent);
            }
        }
    }, {passive: false}); // Use passive: false when preventing default

    document.addEventListener('touchmove', function(e) {
        // Only handle touch moves for card interactions for the tilt effect
        if (e.target.closest('.card')) {
             // Prevent default to avoid scrolling while tilting
            e.preventDefault();
            // Map the first touch point to mousemove
            if (e.touches.length > 0) {
                const touch = e.touches[0];
                const mouseEvent = new MouseEvent('mousemove', {
                    clientX: touch.clientX,
                    clientY: touch.clientY,
                    bubbles: true
                });
                // Dispatch on the card element
                e.target.closest('.card').dispatchEvent(mouseEvent);
            }
        }
    }, {passive: false}); // Use passive: false when preventing default

    document.addEventListener('touchend', function(e) {
        // For touch end on interactive elements
         // Prevent default to avoid double-tap zoom and ensure our click fires
        e.preventDefault();

        if (e.changedTouches.length > 0) {
            const touch = e.changedTouches[0];

            // Find the element at the release position
            // Use elementFromPoint for more accurate targeting after touchmove
            const element = document.elementFromPoint(touch.clientX, touch.clientY);

            if (element) {
                 // Dispatch mouseup and click events
                const mouseUpEvent = new MouseEvent('mouseup', {
                    clientX: touch.clientX,
                    clientY: touch.clientY,
                    bubbles: true,
                    cancelable: true
                });
                 // Dispatch on the found element
                element.dispatchEvent(mouseUpEvent);

                const clickEvent = new MouseEvent('click', {
                    clientX: touch.clientX,
                    clientY: touch.clientY,
                    bubbles: true,
                    cancelable: true
                });
                 // Dispatch on the found element
                element.dispatchEvent(clickEvent);
            }
        }
    }, {passive: false}); // Use passive: false when preventing default

     // Prevent default touchstart on the body to help prevent unwanted scrolling/zooming
    document.body.addEventListener('touchstart', function(e) {
        // Only prevent default if the target is not an input or select
        const targetTagName = e.target.tagName.toLowerCase();
        if (targetTagName !== 'input' && targetTagName !== 'select' && targetTagName !== 'button') {
             e.preventDefault();
        }
    }, { passive: false });
}

// Enhanced card animation initialization
function initCardAnimation(card) {
    if (!card) return;

    const cardInner = card.querySelector('.card-inner');
    let shine = card.querySelector('.card-shine');

    // Ensure shine element exists
    if (!shine) {
        shine = document.createElement('div');
        shine.className = 'card-shine';
        card.appendChild(shine);
    }

    // Check if card is already flipped from previous state (e.g., after shuffle)
    if (cardInner && (cardInner.getAttribute('data-flipped') === 'true' ||
        cardInner.classList.contains('flipped'))) {

        // Ensure consistent state
        cardInner.classList.add('flipped');
        cardInner.setAttribute('data-flipped', 'true');
        cardInner.style.transform = 'rotateY(180deg)';
    } else if (cardInner) {
         // Ensure non-flipped state is consistent
         cardInner.classList.remove('flipped');
         cardInner.setAttribute('data-flipped', 'false');
         cardInner.style.transform = 'rotateY(0deg)'; // Ensure it's reset
    }

    // Determine if device supports hover effects (for tilt)
    const supportsHover = window.matchMedia('(hover: hover)').matches;

    // Remove existing mousemove/mouseleave listeners to prevent duplicates after shuffle
    const oldMouseMove = card.onmousemove;
    const oldMouseLeave = card.onmouseleave;
    if (oldMouseMove) card.removeEventListener('mousemove', oldMouseMove);
    if (oldMouseLeave) card.removeEventListener('mouseleave', oldMouseLeave);

    if (supportsHover && cardInner) {
        // Add mouseenter/mousemove for 3D tilt effect (but only when not flipped)
        const mouseMoveHandler = (e) => {
            // Check current flipped state before applying tilt
            const isFlipped = cardInner.classList.contains('flipped') ||
                             cardInner.getAttribute('data-flipped') === 'true';

            if (isFlipped) {
                 // Reset transform and opacity if it was tilted before flipping
                 cardInner.style.transform = 'rotateY(180deg)'; // Ensure it stays flipped
                 if (shine) shine.style.opacity = '0';
                 return;
            }

            const rect = card.getBoundingClientRect();
            const centerX = rect.left + rect.width / 2;
            const centerY = rect.top + rect.height / 2;
            const mouseX = e.clientX - centerX;
            const mouseY = e.clientY - centerY;

            // Calculate rotation angles
            const rotateY = mouseX * 0.05; // Adjust for sensitivity
            const rotateX = -mouseY * 0.05; // Negative for correct direction

            // Use direct style manipulation for better performance
            cardInner.style.transform = `rotateY(${rotateY}deg) rotateX(${rotateX}deg)`;

            // Animate shine effect
            if (shine) {
                 // Position shine based on mouse position relative to the card
                 const shineX = ((e.clientX - rect.left) / rect.width) * 100;
                 const shineY = ((e.clientY - rect.top) / rect.height) * 100;
                 shine.style.setProperty('--x', `${shineX}%`);
                 shine.style.setProperty('--y', `${shineY}%`);

                const distance = Math.sqrt(mouseX * mouseX + mouseY * mouseY);
                const maxDistance = Math.sqrt((rect.width / 2) * (rect.width / 2) + (rect.height / 2) * (rect.height / 2));
                const normalizedDistance = Math.min(distance / maxDistance, 1);

                shine.style.opacity = (0.4 * normalizedDistance).toString(); // Adjust max opacity
            }
        };

        // Reset on mouse leave
        const mouseLeaveHandler = () => {
            // Check current flipped state before resetting
            const isFlipped = cardInner.classList.contains('flipped') ||
                             cardInner.getAttribute('data-flipped') === 'true';

            if (isFlipped) {
                cardInner.style.transform = 'rotateY(180deg)'; // Ensure it stays flipped
                if (shine) shine.style.opacity = '0';
                return;
            }

            // Use direct style for better performance
            cardInner.style.transform = 'rotateY(0deg) rotateX(0deg)';

            if (shine) {
                shine.style.opacity = '0';
            }
        };

        card.addEventListener('mousemove', mouseMoveHandler);
        card.addEventListener('mouseleave', mouseLeaveHandler);

        // Store handlers to remove them later if needed (e.g., on shuffle)
        card.onmousemove = mouseMoveHandler;
        card.onmouseleave = mouseLeaveHandler;
    } else if (cardInner) {
         // Ensure no tilt transform is applied if hover is not supported
         const isFlipped = cardInner.classList.contains('flipped') ||
                             cardInner.getAttribute('data-flipped') === 'true';
         cardInner.style.transform = isFlipped ? 'rotateY(180deg)' : 'rotateY(0deg)';
         if (shine) shine.style.opacity = '0'; // Hide shine if no hover
    }
}

// Enhanced card flip handler with better mobile support
function handleCardFlip(event) {
    // Find the closest card-inner element to the click target
    const cardInner = event.target.closest('.card-inner');
    if (!cardInner) return; // Exit if the click wasn't inside a card-inner

    // Prevent flipping if the click target was an interactive element inside the card
    const targetTagName = event.target.tagName.toLowerCase();
    if (targetTagName === 'button' || targetTagName === 'input' || targetTagName === 'select') {
         return;
    }

    // Toggle the flipped class
    const isCurrentlyFlipped = cardInner.classList.contains('flipped');

    if (!isCurrentlyFlipped) {
        // Flip to back
        cardInner.classList.add('flipped');
        cardInner.setAttribute('data-flipped', 'true');
        // Apply the flipped transform immediately for responsiveness
        cardInner.style.transform = 'rotateY(180deg)';

         // Hide shine when flipped
         const shine = cardInner.parentElement?.querySelector('.card-shine');
         if(shine) shine.style.opacity = '0';

    } else {
        // Flip to front
        cardInner.classList.remove('flipped');
        cardInner.setAttribute('data-flipped', 'false');
         // Apply the non-flipped transform immediately
        cardInner.style.transform = 'rotateY(0deg)';

         // Shine will reappear on mousemove if hover is supported
    }

    // Stop event propagation to prevent multiple flips if nested elements are clicked
    event.stopPropagation();
}

// Better handling of the timer
let countdown;
let timeLeft = 0;

function startTimer() {
    clearInterval(countdown);

    const minutesInput = document.getElementById('minutes');
    const secondsInput = document.getElementById('seconds');

    const minutes = parseInt(minutesInput?.value) || 0;
    const seconds = parseInt(secondsInput?.value) || 0;

    timeLeft = (minutes * 60) + seconds;

    if (timeLeft <= 0) {
        showMessageBox("Please set a valid time!"); // Use custom message box
        return;
    }

    // Initialize audio context when timer starts
    initAudioContext();

    updateDisplay();

    countdown = setInterval(() => {
        timeLeft--;
        updateDisplay();

        if (timeLeft <= 0) {
            clearInterval(countdown);
            playSound();
        }
    }, 1000);
}

function updateDisplay() {
    const timerDisplay = document.getElementById('timer');
    if (!timerDisplay) return;

    const mins = Math.floor(timeLeft / 60);
    const secs = timeLeft % 60;

    timerDisplay.textContent =
        `${mins.toString().padStart(2, '0')}:${secs.toString().padStart(2, '0')}`;
}

function resetTimer() {
    clearInterval(countdown);
    timeLeft = 0;

    const timerDisplay = document.getElementById('timer');
    if (timerDisplay) {
        timerDisplay.textContent = "00:00";
    }

    const minutesInput = document.getElementById('minutes');
    if (minutesInput) {
        minutesInput.value = "";
    }

    const secondsInput = document.getElementById('seconds');
    if (secondsInput) {
        secondsInput.value = "";
    }
}

// FIXED: Improved card navigation functions
// This is the key function that shows the current card based on window.currentCardIndex
function showCurrentCard() {
    console.log('showCurrentCard called');
    // Get the currently visible stack
    const visibleStack = document.querySelector('.card-stack[style*="display: flex"]') ||
                         document.getElementById('stack1'); // Fallback to stack1

    if (!visibleStack) {
        console.error("No visible card stack found.");
        // Ensure card container is hidden if no stack is found
        const cardContainer = document.querySelector('.card-container');
        if(cardContainer) cardContainer.style.display = 'none';
        return;
    }

    const currentStackId = visibleStack.id;
    console.log('Current Stack ID:', currentStackId);

    // Get all cards in the current stack
    const cardsInCurrentStack = Array.from(document.querySelectorAll(`#${currentStackId} .card`));
    console.log('Number of cards in stack:', cardsInCurrentStack.length);

    if (cardsInCurrentStack.length === 0) {
        console.warn(`No cards found in stack: ${currentStackId}. Hiding card container.`);
        const cardContainer = document.querySelector('.card-container');
        if(cardContainer) cardContainer.style.display = 'none';
        return;
    } else {
        const cardContainer = document.querySelector('.card-container');
        if(cardContainer) cardContainer.style.display = 'flex'; // Ensure container is visible
    }

    // Ensure index is within bounds
    if (window.currentCardIndex >= cardsInCurrentStack.length) {
        window.currentCardIndex = 0; // Reset to the first card if index is too high
        console.log('Index out of bounds (too high), resetting to 0');
    } else if (window.currentCardIndex < 0) {
        window.currentCardIndex = cardsInCurrentStack.length - 1; // Wrap around to the last card
        console.log('Index out of bounds (too low), wrapping to last card');
    }
    console.log('Final currentCardIndex:', window.currentCardIndex);

    // Update cards visibility
    cardsInCurrentStack.forEach((card, index) => {
        const cardInner = card.querySelector('.card-inner');

        if (index === window.currentCardIndex) {
            console.log(`Showing card at index: ${index}`);
            card.style.display = 'block'; // Set display to block

            // Ensure any flipped state is preserved
            if (cardInner) {
                const isFlipped = cardInner.classList.contains('flipped') ||
                                 cardInner.getAttribute('data-flipped') === 'true';

                if (isFlipped) {
                    cardInner.classList.add('flipped');
                    cardInner.setAttribute('data-flipped', 'true');
                    cardInner.style.transform = 'rotateY(180deg)';
                } else {
                    cardInner.classList.remove('flipped');
                    cardInner.setAttribute('data-flipped', 'false');
                    cardInner.style.transform = 'rotateY(0deg)';
                }
                // Re-initialize animation and shine for the displayed card
                initCardAnimation(card);
            }
        } else {
            console.log(`Hiding card at index: ${index}`);
            card.style.display = 'none'; // Set display to none
            // Ensure cards that are hidden are not flipped or tilted
            if (cardInner) {
                cardInner.classList.remove('flipped');
                cardInner.setAttribute('data-flipped', 'false');
                cardInner.style.transform = 'rotateY(0deg)';
            }
            const shine = card.querySelector('.card-shine');
            if(shine) shine.style.opacity = '0';
        }
    });

    // Save current index for this stack for persistence
    localStorage.setItem(`currentCardIndex_${currentStackId}`, window.currentCardIndex.toString());
    console.log('Updated localStorage with currentCardIndex:', window.currentCardIndex);
}

// FIXED: Improved card navigation event handlers
// This function sets up the navigation buttons with clean event handlers
function initCardNavigation() {
    const prevBtn = document.getElementById('prev-card-btn');
    const nextBtn = document.getElementById('next-card-btn');

    if (prevBtn) {
        // Remove any existing event listeners to avoid duplicates
        const oldPrevHandler = prevBtn._clickHandler;
        if (oldPrevHandler) {
            prevBtn.removeEventListener('click', oldPrevHandler);
        }

        // Create new handler
        const prevHandler = () => {
            console.log('Previous button clicked');
            const visibleStack = document.querySelector('.card-stack[style*="display: flex"]');
            const stackId = visibleStack?.id || 'stack1';
            const cardsInStack = document.querySelectorAll(`#${stackId} .card`);

            if (cardsInStack.length === 0) {
                console.warn('No cards in stack, cannot navigate.');
                return; // Do nothing if no cards
            }

            console.log('Before decrement:', window.currentCardIndex);
            window.currentCardIndex--; // Decrement index
            // Wrap around if going below the first card
            if (window.currentCardIndex < 0) {
                window.currentCardIndex = cardsInStack.length - 1;
            }
            console.log('After decrement:', window.currentCardIndex);

            showCurrentCard(); // Show the previous card
        };

        // Store the handler reference for future cleanup
        prevBtn._clickHandler = prevHandler;
        prevBtn.addEventListener('click', prevHandler);
        console.log('Previous card button listener added or replaced.');
    }

    if (nextBtn) {
        // Remove any existing event listeners to avoid duplicates
        const oldNextHandler = nextBtn._clickHandler;
        if (oldNextHandler) {
            nextBtn.removeEventListener('click', oldNextHandler);
        }

        // Create new handler
        const nextHandler = () => {
            console.log('Next button clicked');
            const visibleStack = document.querySelector('.card-stack[style*="display: flex"]');
            const stackId = visibleStack?.id || 'stack1';
            const cardsInStack = document.querySelectorAll(`#${stackId} .card`);

            if (cardsInStack.length === 0) {
                console.warn('No cards in stack, cannot navigate.');
                return; // Do nothing if no cards
            }

            console.log('Before increment:', window.currentCardIndex);
            window.currentCardIndex++; // Increment index
            // Wrap around if going beyond the last card
            if (window.currentCardIndex >= cardsInStack.length) {
                window.currentCardIndex = 0;
            }
            console.log('After increment:', window.currentCardIndex);

            showCurrentCard(); // Show the next card
        };

        // Store the handler reference for future cleanup
        nextBtn._clickHandler = nextHandler;
        nextBtn.addEventListener('click', nextHandler);
        console.log('Next card button listener added or replaced.');
    }
}

// FIXED: Function to initialize navigation when the DOM is loaded
function initializeCardNavigationOnLoad() {
    // Ensure window.currentCardIndex is set to 0 if not already defined
    if (typeof window.currentCardIndex === 'undefined') {
        window.currentCardIndex = 0;
    }
    
    // Initialize the card navigation controls
    initCardNavigation();
    
    // Show the current card based on the index
    showCurrentCard();
}

// FIXED: Updated showStack function for better card stack switching
function showStack(stackId) {
    console.log(`Showing stack: ${stackId}`);
    const stacks = document.querySelectorAll('.card-stack');

    // Hide all stacks
    stacks.forEach(stack => {
        stack.style.display = 'none';
    });

    // Show selected stack
    const selectedStack = document.getElementById(stackId);
    if (selectedStack) {
        selectedStack.style.display = 'flex'; // Use flex for the container
        
        // Get stored index for this stack or reset to 0
        const storedIndex = localStorage.getItem(`currentCardIndex_${stackId}`);
        window.currentCardIndex = storedIndex ? parseInt(storedIndex) : 0;
        
        console.log(`Set index for stack ${stackId} to ${window.currentCardIndex}`);
        showCurrentCard(); // Show the appropriate card in the new stack
        
        // Re-initialize navigation for the new stack
        initCardNavigation();
    } else {
        console.error(`Stack with ID ${stackId} not found.`);
        // Optionally show a message or default to stack1
        showMessageBox(`Card stack "${stackId}" not found. Showing default stack.`);
        showStack('stack1'); // Fallback
    }
}

// Improved responsive handling
function handleResize() {
    const cardContainer = document.querySelector('.card-container');
    if (!cardContainer) return;

    const viewport = {
        width: window.innerWidth,
        height: window.innerHeight
    };

    // Improved card container sizing for better mobile experience
    if (viewport.width < 480) {
        // Small phones
        cardContainer.style.width = '95vw';
        cardContainer.style.height = '60vh'; // Adjusted height
    } else if (viewport.width < 768) {
        // Mobile devices
        cardContainer.style.width = '90vw';
        cardContainer.style.height = '65vh'; // Adjusted height
    } else if (viewport.width < 1024) {
        // Tablets
        cardContainer.style.width = '80vw';
        cardContainer.style.height = '70vh'; // Adjusted height
    } else {
        // Desktop
        cardContainer.style.width = '70vw';
        cardContainer.style.height = '75vh'; // Adjusted height
    }

    // Landscape mode specific adjustments with better handling
    if (viewport.width > viewport.height) {
        // Make cards less tall in landscape mode, but not too small
        cardContainer.style.height = Math.min(viewport.height * 0.8, 600) + 'px'; // Max height in landscape
    }

    // Adjust card font sizes
    const cards = document.querySelectorAll('.card');
    cards.forEach(card => {
        const cardFront = card.querySelector('.card-front');
        const cardBack = card.querySelector('.card-back');

        if (viewport.width < 480) {
            // Extra small font for small phones
            if (cardFront) cardFront.style.fontSize = '1rem';
            if (cardBack) cardBack.style.fontSize = '0.9rem';
        } else if (viewport.width < 768) {
            // Smaller font on mobile
            if (cardFront) cardFront.style.fontSize = '1.2rem';
            if (cardBack) cardBack.style.fontSize = '1rem';
        } else {
            // Normal font on larger screens
            if (cardFront) cardFront.style.fontSize = '1.5rem';
            if (cardBack) cardBack.style.fontSize = '1.2rem';
        }
    });
}

        // DOM ready function with improved initialization
        document.addEventListener('DOMContentLoaded', () => {
            console.log('DOMContentLoaded fired');
            // Set all event listeners
            const startTimerBtn = document.getElementById('start-timer-btn');
            if (startTimerBtn) {
                startTimerBtn.addEventListener('click', startTimer);
                console.log('Timer start button listener added.');
            }

            const resetTimerBtn = document.getElementById('reset-timer-btn');
            if (resetTimerBtn) {
                resetTimerBtn.addEventListener('click', resetTimer);
                 console.log('Timer reset button listener added.');
            }

            // Make sure audio elements are loaded properly
            const buzzer = document.getElementById('buzzer');
            if (buzzer) {
                 // Ensure the path is correct for your file structure
                buzzer.src = 'digital-timer-beeping-epic-stock-media-1-00-08.mp3';
                buzzer.load();
                buzzer.volume = 0.5; // Lower volume on mobile
                 console.log('Buzzer audio loaded.');
            }

            // Use event delegation for card flipping
            // Attach to the card container or a higher parent for efficiency
            const cardContainer = document.querySelector('.card-container');
            if(cardContainer) {
                 cardContainer.addEventListener('click', handleCardFlip);
                 console.log('Card container click listener for flip added.');
            }


            // Initialize touch support
            enableTouchSupport();
            console.log('Touch support enabled.');

            // Initialize all cards with animation properties (even if hidden)
            const allCards = document.querySelectorAll('.card');
            allCards.forEach(card => {
                initCardAnimation(card);
            });
            console.log(`Initialized animation for ${allCards.length} cards.`);

            // Set up button handlers
            const shuffleBtn = document.getElementById('shuffle-btn');
            if (shuffleBtn) {
                shuffleBtn.addEventListener('click', () => {
                    console.log('Shuffle button clicked.');
                    const activeStack = document.querySelector('.card-stack[style*="display: flex"]');
                    const currentStackId = activeStack?.id || 'stack1';

                    if (!currentStackId) {
                        showMessageBox("Please select a stack first!");
                        return;
                    }

                    const cards = Array.from(document.querySelectorAll(`#${currentStackId} .card`));

                    if (cards.length === 0) {
                         showMessageBox(`No cards to shuffle in stack: ${currentStackId}`);
                         return;
                    }

                    // Store card contents and their flipped state
                    const cardContents = cards.map(card => {
                         const cardInner = card.querySelector('.card-inner');
                        return {
                            html: cardInner ? cardInner.innerHTML : card.innerHTML, // Store innerHTML for front/back
                            isFlipped: cardInner ? (cardInner.classList.contains('flipped') || cardInner.getAttribute('data-flipped') === 'true') : false
                        };
                    });

                    // Shuffle contents using Fisher-Yates (Knuth) algorithm
                    for (let i = cardContents.length - 1; i > 0; i--) {
                        const j = Math.floor(Math.random() * (i + 1));
                        [cardContents[i], cardContents[j]] = [cardContents[j], cardContents[i]];
                    }

                    // Update cards with shuffled contents and re-initialize
                    cards.forEach((card, index) => {
                         const cardInner = card.querySelector('.card-inner');
                         if (cardInner) {
                             cardInner.innerHTML = cardContents[index].html; // Restore front/back
                             // Ensure shine element is re-added after innerHTML replacement
                             let shine = card.querySelector('.card-shine');
                             if (!shine) {
                                 shine = document.createElement('div');
                                 shine.className = 'card-shine';
                                 card.appendChild(shine);
                             }

                             // Set flip state from shuffled content
                             if (cardContents[index].isFlipped) {
                                 cardInner.classList.add('flipped');
                                 cardInner.setAttribute('data-flipped', 'true');
                                 cardInner.style.transform = 'rotateY(180deg)';
                             } else {
                                 cardInner.classList.remove('flipped');
                                 cardInner.setAttribute('data-flipped', 'false');
                                 cardInner.style.transform = 'rotateY(0deg)';
                             }
                         } else {
                              // Handle case where card doesn't have card-inner (shouldn't happen with this structure)
                             card.innerHTML = cardContents[index].html;
                         }

                         // Re-initialize animation and shine for the updated card
                         initCardAnimation(card);
                    });

                    // Reset index and show first card of the shuffled stack
                    window.currentCardIndex = 0;
                    localStorage.setItem(`currentCardIndex_${currentStackId}`, '0');
                    showCurrentCard();
                    console.log('Stack shuffled and first card shown.');

                });
                 console.log('Shuffle button listener added.');
            }

            // Stack selector
            const stackSelect = document.getElementById('stack-select');
            if (stackSelect) {
                stackSelect.addEventListener('change', (e) => {
                    console.log('Stack select changed.');
                    const stackNum = e.target.value;
                    const stackId = `stack${stackNum}`;
                    showStack(stackId);
                });
                 console.log('Stack select listener added.');
            }

            // Card navigation
            const prevBtn = document.getElementById('prev-card-btn');
            const nextBtn = document.getElementById('next-card-btn');

            if (prevBtn) {
                prevBtn.addEventListener('click', () => {
                    console.log('Previous button clicked');
                    const visibleStack = document.querySelector('.card-stack[style*="display: flex"]');
                    const stackId = visibleStack?.id || 'stack1';
                    const cardsInStack = document.querySelectorAll(`#${stackId} .card`);

                    if (cardsInStack.length === 0) {
                         console.warn('No cards in stack, cannot navigate.');
                         return; // Do nothing if no cards
                    }

                    console.log('Before decrement:', window.currentCardIndex);
                    window.currentCardIndex--; // Decrement index
                     // Wrap around if going below the first card
                    if (window.currentCardIndex < 0) {
                         window.currentCardIndex = cardsInStack.length - 1;
                    }
                    console.log('After decrement:', window.currentCardIndex);

                    showCurrentCard(); // Call showCurrentCard after updating index
                });
                 console.log('Previous card button listener added.');
            }

            if (nextBtn) {
                nextBtn.addEventListener('click', () => {
                    console.log('Next button clicked');
                    const visibleStack = document.querySelector('.card-stack[style*="display: flex"]');
                    const stackId = visibleStack?.id || 'stack1';
                    const cardsInStack = document.querySelectorAll(`#${stackId} .card`);

                     if (cardsInStack.length === 0) {
                         console.warn('No cards in stack, cannot navigate.');
                         return; // Do nothing if no cards
                     }

                    console.log('Before increment:', window.currentCardIndex);
                    window.currentCardIndex++; // Increment index
                    // Wrap around if going beyond the last card
                    if (window.currentCardIndex >= cardsInStack.length) {
                        window.currentCardIndex = 0;
                    }
                    console.log('After increment:', window.currentCardIndex);

                    showCurrentCard(); // Call showCurrentCard after updating index
                });
                 console.log('Next card button listener added.');
            }

            // Init difficulty buttons
            const difficultyButtons = {
                'low-btn': 'low',
                'medium-btn': 'medium',
                'high-btn': 'high'
            };

            const difficultyLevels = {
                low: {
                    name: 'Low',
                    reps: [2, 4, 6, 8, 10],
                    color: '#27ae60'
                },
                medium: {
                    name: 'Medium',
                    reps: [4, 8, 12, 16, 20, 24],
                    color: '#f39c12'
                },
                high: {
                    name: 'High',
                    reps: [5, 10, 15, 20, 25, 30],
                    color: '#e74c3c'
                }
            };

            Object.entries(difficultyButtons).forEach(([btnId, difficulty]) => {
                const btn = document.getElementById(btnId);
                if (btn) {
                    btn.addEventListener('click', () => {
                        console.log(`Difficulty button clicked: ${difficulty}`);
                        // Remove active from all buttons
                        Object.keys(difficultyButtons).forEach(id => {
                            document.getElementById(id)?.classList.remove('active');
                        });

                        // Set active on current button
                        btn.classList.add('active');

                        // Update difficulty info
                        const diffInfo = document.getElementById('difficulty-info');
                        if (diffInfo) {
                            const level = difficultyLevels[difficulty];
                            diffInfo.textContent = `Current Level: ${level.name} (${level.reps.join(', ')} reps)`;
                        }
                    });
                     console.log(`Difficulty button listener added for: ${btnId}`);
                }
            });

            // Set the initial difficulty info based on the default active button (Low)
             const initialDifficultyBtn = document.querySelector('.difficulty-buttons .btn.active');
             if (initialDifficultyBtn) {
                 const initialDifficulty = difficultyButtons[initialDifficultyBtn.id];
                 const diffInfo = document.getElementById('difficulty-info');
                 if (diffInfo && initialDifficulty) {
                     const level = difficultyLevels[initialDifficulty];
                     diffInfo.textContent = `Current Level: ${level.name} (${level.reps.join(', ')} reps)`;
                 }
             }


            // Roll dice button
            const rollDiceBtn = document.getElementById('roll-dice-btn');
            if (rollDiceBtn) {
                rollDiceBtn.addEventListener('click', () => {
                    console.log('Roll dice button clicked.');
                    rollDiceBtn.disabled = true; // Disable button while rolling

                    const diceImage = document.getElementById('diceImage');
                    if (!diceImage) {
                        rollDiceBtn.disabled = false;
                        console.error('Dice image element not found.');
                        return;
                    }

                    // Default dice images (replace with your actual paths for 1-6)
                    // Make sure you have IMG_4702_1.PNG, IMG_4702_2.PNG, ..., IMG_4702_6.PNG
                    const diceImagePaths = [
                        'IMG_4702_1.PNG', 'IMG_4702_2.PNG', 'IMG_4702_3.PNG',
                        'IMG_4702_4.PNG', 'IMG_4702_5.PNG', 'IMG_4702_6.PNG'
                    ];

                     if (diceImagePaths.length === 0) {
                         console.error('Dice image paths are not configured.');
                         rollDiceBtn.disabled = false;
                         return;
                     }


                    diceImage.classList.add('rolling'); // Start animation

                    let rollCount = 0;
                    const rollInterval = setInterval(() => {
                        // Show random dice faces during the roll animation
                        const randomIndex = Math.floor(Math.random() * diceImagePaths.length);
                        diceImage.src = diceImagePaths[randomIndex];
                        rollCount++;

                        if (rollCount >= 15) { // Roll for a bit longer for visual effect
                            clearInterval(rollInterval);

                            // Final roll (1-6)
                            const finalRoll = Math.floor(Math.random() * 6) + 1;
                            // Ensure the image path is correct for the final roll value
                            diceImage.src = diceImagePaths[finalRoll - 1];
                            console.log(`Final dice roll: ${finalRoll}`);

                            // Calculate reps based on difficulty
                            let currentDifficulty = 'low';
                            if (document.getElementById('medium-btn')?.classList.contains('active')) {
                                currentDifficulty = 'medium';
                            } else if (document.getElementById('high-btn')?.classList.contains('active')) {
                                currentDifficulty = 'high';
                            }
                             console.log(`Current difficulty for reps: ${currentDifficulty}`);

                            // Get rep count based on the final roll and difficulty level
                            const repsArray = difficultyLevels[currentDifficulty]?.reps || difficultyLevels['low'].reps; // Fallback to low
                            const repCount = repsArray[Math.min(finalRoll - 1, repsArray.length - 1)]; // Get reps based on roll index
                            console.log(`Calculated rep count: ${repCount}`);


                            // Update total reps display
                            const totalRepsDisplay = document.getElementById('totalReps');
                            if (totalRepsDisplay) {
                                const currentTotal = parseInt(totalRepsDisplay.textContent.replace('Total Reps: ', '') || '0');
                                totalRepsDisplay.textContent = `Total Reps: ${currentTotal + repCount}`;
                                console.log(`Total reps updated to: ${totalRepsDisplay.textContent}`);
                            }

                            // Stop animation and re-enable button after a short delay
                            setTimeout(() => {
                                diceImage.classList.remove('rolling');
                                rollDiceBtn.disabled = false;
                                console.log('Dice roll animation finished, button re-enabled.');
                            }, 500); // Match animation duration
                        }
                    }, 100); // Change dice image every 100ms
                });
                 console.log('Roll dice button listener added.');
            }

            // Reset dice button
            const resetDiceBtn = document.getElementById('reset-dice-btn');
            if (resetDiceBtn) {
                resetDiceBtn.addEventListener('click', () => {
                    console.log('Reset dice button clicked.');
                    const totalRepsDisplay = document.getElementById('totalReps');
                    if (totalRepsDisplay) {
                        totalRepsDisplay.textContent = 'Total Reps: 0';
                         console.log('Total reps reset to 0.');
                    }

                    const diceImage = document.getElementById('diceImage');
                    if (diceImage) {
                         // Set back to the default dice image (e.g., showing 1)
                        diceImage.src = 'IMG_4702_1.PNG'; // Or your preferred default
                         console.log('Dice image reset.');
                    }
                });
                 console.log('Reset dice button listener added.');
            }

            // Tally buttons
            const tallyBtn = document.getElementById('tally-btn');
            if (tallyBtn) {
                tallyBtn.addEventListener('click', () => {
                    console.log('Tally button clicked.');
                    const tallyDisplay = document.getElementById('tallyCountDisplay');
                    if (tallyDisplay) {
                        const currentTally = parseInt(tallyDisplay.textContent.replace('Tally Count: ', '') || '0');
                        tallyDisplay.textContent = `Tally Count: ${currentTally + 1}`;
                         console.log(`Tally count incremented to: ${tallyDisplay.textContent}`);
                    }
                });
                 console.log('Tally button listener added.');
            }

            const resetTallyBtn = document.getElementById('reset-tally-btn');
            if (resetTallyBtn) {
                resetTallyBtn.addEventListener('click', () => {
                    console.log('Reset tally button clicked.');
                    const tallyDisplay = document.getElementById('tallyCountDisplay');
                    if (tallyDisplay) {
                        tallyDisplay.textContent = 'Tally Count: 0';
                         console.log('Tally count reset to 0.');
                    }
                });
                 console.log('Reset tally button listener added.');
            }

            // Initial responsive layout
            handleResize();
            console.log('Initial resize handled.');

            // Show the first stack and its first card on load
            showStack('stack1');
             console.log('Initial stack (stack1) shown.');
        });

        // Set resize handlers
        window.addEventListener('resize', handleResize);
        window.addEventListener('orientationchange', () => {
            // Short delay to allow orientation change to complete
            setTimeout(handleResize, 300);
        });
         console.log('Resize and orientationchange listeners added.');


    </script>
</body>
</html>